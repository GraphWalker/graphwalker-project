[![Maven Central](https://maven-badges.herokuapp.com/maven-central/org.graphwalker/graphwalker-core/badge.svg)](https://maven-badges.herokuapp.com/maven-central/org.graphwalker/graphwalker-core)
GraphWalker Core
===================

=======
This is the GraphWalker major version 3. For earlier versions of GraphWalker, see: [GraphWalker 2].


### What is GraphWalker

GraphWalker is a Model-based testing tool which uses directed graphs (finite state diagram). The graphs are expressions of a systems expected behavior. It's not a description of the actual system under test, rather than it is an expression of of the test design. See [Finite State Model-Based Testing on a Shoestring] as an example.

GraphWalker generates test sequences from the graph. The test sequences are then used to run the actual tests.

For a working implementation of GW3, please see: https://github.com/GraphWalker/graphwalker-cli

### Design goal
Graphwalker-core provides only the
basic functionality for:
* model data structure
* algorithms
* stop conditions
* events
* path generators
* machines
* statistics

For example, the core itself does not know how to read and parse models from file, that's handles by another module: **graphwalker-io**. The obvious advantage for this is that it will be easier to extend graphwalker to ones own needs.

### How to build and install locally
```sh
git clone https://github.com/GraphWalker/graphwalker-project.git
git clone https://github.com/GraphWalker/graphwalker-core.git
cd graphwalker-core
mvn install
```

### Include it into your maven project
For a maven project just add this dependency:
```xml
<dependency>
    <groupId>org.graphwalker</groupId>
    <artifactId>graphwalker-core</artifactId>
    <version>4.0.0</version>
</dependency>
```

### Example

```java
import org.graphwalker.core.condition.VertexCoverage;
import org.graphwalker.core.generator.PathGenerator;
import org.graphwalker.core.generator.RandomPath;
import org.graphwalker.core.machine.Context;
import org.graphwalker.core.machine.ExecutionContext;
import org.graphwalker.core.machine.Machine;
import org.graphwalker.core.machine.SimpleMachine;
import org.graphwalker.core.model.Edge;
import org.graphwalker.core.model.Model;
import org.graphwalker.core.model.Vertex;
import org.junit.Test;

public class SimpleTest {

    @Test
    public void runTestWithOnlyCore() {
        // create a model
        Vertex start = new Vertex();
        Model model = new Model().addEdge(new Edge()
            .setSourceVertex(start)
            .setTargetVertex(new Vertex().setName("myTestMethod")));
        // create a context based on the model and a path generator
        PathGenerator pathGenerator = new RandomPath(new VertexCoverage(100));
        Context context = new TestContext(model, pathGenerator);
        // set the start vertex as our start point
        context.setNextElement(start);
        // create a machine and execute the test
        Machine machine = new SimpleMachine(context);
        while (machine.hasNextStep()) {
            machine.getNextStep();
        }
    }

    // needs to be public, because it will be instantiated from graphwalker
    public class TestContext extends ExecutionContext {

        public TestContext(Model model, PathGenerator pathGenerator) {
            super(model, pathGenerator);
        }

        public void myTestMethod() {
            // This is executed during the model execution
        }
    }
}
```


### Model data structure
The model represents a finite state diagram. It consists of vertices (nodes or states) and edges (transitions).

### Algorithms
Are used by path generators. The [algorithm] provides the generators the logic for how to traverse a model. Examples of algorithms are:
* [A Star]
* [Depth-first Search]
* [Eulerian]
* [Fleury]
* [Floyd-Warshall]

### Stop conditions
Used by path generators to determine when to stop generating a path. Stop conditions can be logically AND'ed and OR'ed. When a stop condition (or a combination of several) evaluates to true, the generator stops. Examples are:
* **Edge coverage** - The condition is a percentage number. When, during execution, the percentage of traversed edges are reached, the test is stopped. If an edge is traversed more than one time, it still counts as 1, when calculating the percentage coverage.
* **Length** - The condition is a number, representing the total numbers of pairs of vertices and edges generated by a generator. For example, if the number is 110, the test sequence would be 220 lines long. (including 110 pairs of edges and vertices).
* **Never** - This special condition will never halt the generator.
* **Reached edge** - The condition is a named edge. When, during execution, the edge is reached, the test is stopped.
* **Reached vertex** - The stop criteria is a named vertex. When, during execution, the vertex is reached, the test is stopped.
* **Requirement coverage** - The condition is a percentage number. When, during execution, the percentage of traversed requirements is reached, the test is stopped. If an requirement is traversed more than one time, it still counts as 1, when calculating the percentage coverage.
* **Time duration** - The condition is a time, representing the number of seconds that the test generator is allowed to execute.
* **Vertex coverage** - The condition is a percentage number. When, during execution, the percentage of traversed vertices are reached, the test is stopped. If a vertex is traversed more than one time, it still counts as 1, when calculating the percentage coverage.


### Events
An implementation of the [Observer pattern]. For instance, the [SimpleMachine] implements the pattern, and notifies observers when following has happened:
* [SimpleMachine.walk] - When a machine generates a path using some generator, it walks the generated path. Everytime a step is walked, this method is called, and thus an observer can be notified of this event.


### Generators
A generator used an algorithm to decide how to traverse a model. Different generators will generate different test sequences, and they will navigate them in different ways.

* **AStarPath** - Navigate through the model in a completely random manor. Also called "Drunkard’s walk", or "Random walk". This algorithm selects an out-edge from a vertex by random, and repeats the process in the next vertex.
* **QuickRandomPath** - Tries to run the shortest path through a model, but in a fast fashion. This is how the algorithm works:
   1. Choose an edge not yet visited by random.
   1. Select the shortest path to that edge using the A Star algorithm
   1. Walk that path, and mark all those edges being executed as visited.
   1. When reaching the selected edge in step 1, start all over, repeating steps 1->4.

   The algorithm works well an very large models, and generates reasonably short sequences. The downside is when used in conjunction with EFSM, the algorithm can choose a path which is blocked by a guard.
* **RandomPath** - Navigate through the model in a completely random manor. Also called "Drunkard’s walk", or "Random walk". This algorithm selects an out-edge from a vertex by random, and repeats the process in the next vertex.


### Machines
A machine is the mechanism that generates an actual path, given:
* the data in the model(s)
* the generator(s)
* the stop condition(s)

An example of a machine is the [SimpleMachine].

### Statistics
Keeps track of the metrics, such as which parts of the model has been executed.


### License
GraphWalker is using the [MIT license].


[GraphWalker 2]:https://github.com/KristianKarl/GraphWalker
[Finite State Model-Based Testing on a Shoestring]:http://www.harryrobinson.net/MBT-on-a-shoestring.pdf
[A Star]:http://en.wikipedia.org/wiki/A*_search_algorithm
[Depth-first Search]:http://en.wikipedia.org/wiki/Depth-first_search
[Eulerian]:http://en.wikipedia.org/wiki/Eulerian_path
[Fleury]:http://en.wikipedia.org/wiki/Eulerian_path#Fleury.27s_algorithm
[Floyd-Warshall]:http://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm
[Observer pattern]:http://en.wikipedia.org/wiki/Observer_pattern
[SimpleMachine]:https://github.com/GraphWalker/graphwalker-core/blob/master/src/main/java/org/graphwalker/core/machine/SimpleMachine.java#L44
[SimpleMachine.walk]:https://github.com/GraphWalker/graphwalker-core/blob/master/src/main/java/org/graphwalker/core/machine/SimpleMachine.java#L75
[MIT license]:http://opensource.org/licenses/MIT
